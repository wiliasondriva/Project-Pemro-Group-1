---
title: "Project Pemrograman Statistika"
author: "Kelompok 1"
date: "2025-10-18"
output: html_document
editor_options: 
  markdown: 
    wrap: sentence
---

## Pendahuluan

Dokumen ini menjelaskan proses *data wrangling* (pembersihan dan transformasi data) untuk menggabungkan dua dataset:

1.  **Data Tindak Pidana (Source 1):** Berisi jumlah kejahatan yang dilaporkan per Satuan Wilayah Hukum (Polres).
2.  **Data Sosial Ekonomi (Source 2):** Berisi berbagai indikator sosial ekonomi per Kabupaten/Kota.

## 1. Setup Awal

Pertama, muat *package* yang diperlukan.
Package `dplyr` akan digunakan untuk sebagian besar proses wrangling.

```{r}
# Memuat library yang diperlukan
library(dplyr)
library(readxl)
library(writexl)

# -----------------------------------------------------------------
# MEMUAT DATA
# -----------------------------------------------------------------

# Memuat Data Tindak Pidana (Source 1)
# Kita beri nama 'df_pidana'
df_pidana <- read_excel("data tindak pidana.xlsx", sheet = "Sheet1")

# Memuat Data Sosial Ekonomi (Source 2)
# Kita beri nama 'df_sosek'
df_sosek <- read_excel("data sosek.xlsx", sheet = "Sheet1")

# Menampilkan beberapa baris pertama dari setiap data
head(df_pidana)
head(df_sosek)
```

## 2. Proses Data Wrangling

Beberapa langkah wrangling akan dilakukan untuk bisa menggabungkan kedua data ini.

### Langkah 1: Subsetting Data Tindak Pidana

Data df_pidana memiliki baris Polda Jawa Barat yang merupakan data agregat level provinsi.
Untuk analisis level Kabupaten/Kota (Polres), baris ini tidak diperlukan.
Teknik Subsetting data akan digunakan untuk menghapus baris tersebut.
Dalam dplyr, dapat menggunakan fungsi filter().

```{r}
# Teknik: Subsetting Data 
# Memfilter data untuk MENGECUALIKAN "Polda Jawa Barat"
pidana_clean <- df_pidana %>%
  filter(`Satuan Wilayah Hukum` != "Polda Jawa Barat")

# Menampilkan hasil
head(pidana_clean)
```

### Langkah 2: Recoding & Agregasi Data Sosek

Nama wilayah di df_pidana (Satuan Wilayah Hukum) tidak sama persis dengan df_sosek (nama_kabupaten_kota).
Selain itu, ada wilayah yang digabung.
Contohnya: Polres Cimahi wilayah hukumnya mencakup KOTA CIMAHI dan KABUPATEN BANDUNG BARAT.

Pengisian data di Polres Cimahi akan dilakukan dengan rata-rata dari data Sosek kedua wilayah tersebut.
Oleh karena itu, perlu dilakukan 3 teknik sebagai berikut:

1\.
Menciptakan variabel baru: Buat kolom Satuan Wilayah Hukum baru di df_sosek.

2\.
Recoding data: Petakan nama_kabupaten_kota ke Satuan Wilayah Hukum yang sesuai.
Gunakan case_when().

3\.
Agregasi Data : Kelompokkan (group_by) berdasarkan Satuan Wilayah Hukum yang baru dan hitung rata-ratanya (summarise) menggunakan mean().

```{r}
# Teknik: Menciptakan Variabel Baru  & Recoding Data 
sosek_mapped <- df_sosek %>%
  mutate(
    `Satuan Wilayah Hukum` = case_when(
      # Mapping 1-ke-1
      nama_kabupaten_kota == "KABUPATEN BOGOR" ~ "Polres Bogor",
      nama_kabupaten_kota == "KABUPATEN CIAMIS" ~ "Polres Ciamis",
      nama_kabupaten_kota == "KABUPATEN CIANJUR" ~ "Polres Cianjur",
      nama_kabupaten_kota == "KABUPATEN GARUT" ~ "Polres Garut",
      nama_kabupaten_kota == "KABUPATEN INDRAMAYU" ~ "Polres Indramayu",
      nama_kabupaten_kota == "KABUPATEN KARAWANG" ~ "Polres Karawang",
      nama_kabupaten_kota == "KABUPATEN KUNINGAN" ~ "Polres Kuningan",
      nama_kabupaten_kota == "KABUPATEN MAJALENGKA" ~ "Polres Majalengka",
      nama_kabupaten_kota == "KABUPATEN PANGANDARAN" ~ "Polres Pangandaran",
      nama_kabupaten_kota == "KABUPATEN PURWAKARTA" ~ "Polres Purwakarta",
      nama_kabupaten_kota == "KABUPATEN SUBANG" ~ "Polres Subang",
      nama_kabupaten_kota == "KABUPATEN SUKABUMI" ~ "Polres Sukabumi",
      nama_kabupaten_kota == "KABUPATEN SUMEDANG" ~ "Polres Sumedang",
      nama_kabupaten_kota == "KABUPATEN TASIKMALAYA" ~ "Polres Tasikmalaya",
      nama_kabupaten_kota == "KOTA BANJAR" ~ "Polres Kota Banjar",
      nama_kabupaten_kota == "KOTA BOGOR" ~ "Polresta Kota Bogor",
      nama_kabupaten_kota == "KOTA SUKABUMI" ~ "Polres Kota Sukabumi",
      nama_kabupaten_kota == "KOTA TASIKMALAYA" ~ "Polres Kota Tasikmalaya",
      
      # Mapping Polresta Bandung & Cirebon
      nama_kabupaten_kota == "KABUPATEN BANDUNG" ~ "Polresta Bandung",
      nama_kabupaten_kota == "KOTA BANDUNG" ~ "Polrestabes Kota Bandung",
      nama_kabupaten_kota == "KABUPATEN CIREBON" ~ "Polresta Cirebon",
      nama_kabupaten_kota == "KOTA CIREBON" ~ "Polres Kota Cirebon",
  
      # Polres Cimahi = Kota Cimahi + Kab. Bandung Barat
      nama_kabupaten_kota == "KOTA CIMAHI" ~ "Polres Cimahi",
      nama_kabupaten_kota == "KABUPATEN BANDUNG BARAT" ~ "Polres Cimahi",
      
      # Wilayah yang tidak ada di data pidana (akan ter-filter)
      TRUE ~ NA_character_ 
    )
  )

# Teknik: Agregasi Data 
sosek_agg <- sosek_mapped %>%
  group_by(`Satuan Wilayah Hukum`) %>%
  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE))) %>%
  ungroup() 
# Filter untuk melihat Polres Cimahi sebagai bukti
filter(sosek_agg, `Satuan Wilayah Hukum` == "Polres Cimahi")
```

### Langkah 3: Menggabungkan Data (Merging)

Sekarang, ada dua data frame yang bersih dan siap digabung: pidana_clean dan sosek_agg Keduanya memiliki kolom kunci yang sama: Satuan Wilayah Hukum.
Teknik Merging Data atau Integrasi Data akan digunakan untuk menggabungkan kedua data frame ini.

```{r}
# Teknik: Merging Data  menggunakan inner_join 
data_final <- inner_join(
  pidana_clean, 
  sosek_agg, 
  by = "Satuan Wilayah Hukum"
)

# Menampilkan hasil akhir, gunakan print() agar tampilannya rapi
print(as_data_frame(data_final), n = 30)

# EKSPOR DATA FINAL 
write_xlsx(data_final, "data_final_bersih.xlsx")
```

## 3. Kesimpulan

Proses data wrangling yang dilakukan untuk data ini yaitu:

\- Membersihkan data pidana menggunakan Subsetting.

\- Menstandardisasi wilayah di data sosial ekonomi menggunakan Recoding dan menciptakan variabel baru.

\- Menangani kasus wilayah gabungan (seperti Polres Cimahi) menggunakan Agregasi Data (group_by dan summarise).

\- Menggabungkan kedua data menggunakan Merging Data (inner_join).

Hasil data_final kini siap untuk dianalisis lebih lanjut.
